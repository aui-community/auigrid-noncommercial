<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1"> 
<meta name="og:title" content="HTML5, ìë°”ìŠ¤í¬ë¦½íŠ¸ ë°ì´í„°ê·¸ë¦¬ë“œ AUIGrid">
<meta name="og:url" content="https://www.auisoft.net/">
<meta name="og:description" content="HTML5, ìë°”ìŠ¤í¬ë¦½íŠ¸ ë°ì´íƒ€ê·¸ë¦¬ë“œ(javascript datagrid) AUISoft">
<title>AUIGrid v3.0 ìƒ˜í”Œ- HTML5, ìë°”ìŠ¤í¬ë¦½íŠ¸ ë°ì´í„°ê·¸ë¦¬ë“œ AUIGrid</title>
<link href="https://www.auisoft.net/aui.ico" rel="shortcut icon" />

<!-- ë°ëª¨ êµ¬ì„±ìš© CSS ì…ë‹ˆë‹¤. ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œëŠ” ë¶ˆí•„ìš” í•˜ë‹ˆ ì¶”ê°€í•  í•„ìš” ì—†ìŠµë‹ˆë‹¤. -->
<link href="./demo.css" rel="stylesheet">

<!-- ë°ëª¨ìš© ê³µìš© ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤. ì—¬ê¸°ì— ê³µí†µì ì¸ ìŠ¤í¬ë¦½íŠ¸ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œëŠ” ë¶ˆí•„ìš” í•˜ë‹ˆ ì¶”ê°€í•  í•„ìš” ì—†ìŠµë‹ˆë‹¤. -->
<script type="text/javascript" src="./common.js"></script>

<!-- AUIGrid í…Œë§ˆ CSS íŒŒì¼ì…ë‹ˆë‹¤. ê·¸ë¦¬ë“œ ì¶œë ¥ì„ ìœ„í•´ ê¼­ ì‚½ì…í•˜ì‹­ì‹œì˜¤. -->
<!-- ì›í•˜ëŠ” í…Œë§ˆê°€ ìˆë‹¤ë©´, ë‹¤ë¥¸ íŒŒì¼ë¡œ êµì²´ í•˜ì‹­ì‹œì˜¤. -->
<link href="../AUIGrid/AUIGrid_style.css" rel="stylesheet">

<!-- AUIGrid ë¼ì´ì„¼ìŠ¤ íŒŒì¼ì…ë‹ˆë‹¤. ê·¸ë¦¬ë“œ ì¶œë ¥ì„ ìœ„í•´ ê¼­ ì‚½ì…í•˜ì‹­ì‹œì˜¤. -->
<script type="text/javascript" src="../AUIGrid/AUIGridLicense.js"></script>

<!-- AUIGrid ì»´í¬ë„ŒíŠ¸ JS íŒŒì¼ì…ë‹ˆë‹¤. ê·¸ë¦¬ë“œ ì¶œë ¥ì„ ìœ„í•´ ê¼­ ì‚½ì…í•˜ì‹­ì‹œì˜¤.--> 
<script type="text/javascript" src="../AUIGrid/AUIGrid.js"></script>


<!-- SheetJS js-xlsx, https://github.com/SheetJS/js-xlsx-->
<!-- Apache License v2.0  (https://www.apache.org/licenses/LICENSE-2.0) -->
<script type="text/javascript" src="./js-xlsx/xlsx.full.min.js"></script>

<style>
	.custom-file-upload {
		display: inline-block;
		padding: 10px 20px;
		cursor: pointer;
		background-color: #374151;
		color: white;
		font-size: 14px;
		font-family: 'Segoe UI', sans-serif;
		border: none;
		border-radius: 4px;
		transition: background-color 0.3s ease;
	}

	.custom-file-upload:hover {
		background-color: #1f2937;
	}

	/* ì‹¤ì œ inputì€ ìˆ¨ê¹€ ì²˜ë¦¬ */
	#fileSelector {
		display: none;
	}
</style>
<script>
	// AUIGrid ìƒì„± í›„ ë°˜í™˜ ID
	let myGridID;

	// ì‹œì‘ì 
	function init() {
		// ìµœì´ˆ ë¹ˆ ê·¸ë¦¬ë“œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
		createInitGrid();

		// íŒŒì¼ ì„ íƒí•˜ê¸°
		document.getElementById('fileSelector').addEventListener('change', (event) => {
			const file = event.target.files[0];
			if (!file) {
				alert("íŒŒì¼ ì„ íƒ ì‹œ ì˜¤ë¥˜ ë°œìƒ!!");
				return;
			}

			const reader = new FileReader();
			reader.onload = (e) => {
				const data = e.target.result;
				let workbook;

				// ì¼ë°˜ì ì¸ ë°”ì´ë„ˆë¦¬
				workbook = XLSX.read(data, { type: 'binary' });

				const jsonObj = process_wb(workbook);
				const firstSheetName = Object.keys(jsonObj)[0];
				createAUIGrid(jsonObj[firstSheetName]);
			};
			reader.readAsBinaryString(file);
		});
	}

	// íŒŒì‹±ëœ ì‹œíŠ¸ì˜ CDATA ì œê±° í›„ ë°˜í™˜.
	function process_wb(wb) {
		let output = "";
		output = JSON.stringify(to_json(wb));
		output = output.replace(/<!\[CDATA\[(.*?)\]\]>/g, '$1');
		return JSON.parse(output);
	};

	// ì—‘ì…€ ì‹œíŠ¸ë¥¼ íŒŒì‹±í•˜ì—¬ ë°˜í™˜
	function to_json(workbook) {
		const result = {};
		workbook.SheetNames.forEach(function (sheetName) {
			// JSON ìœ¼ë¡œ íŒŒì‹±
			//let roa = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);

			// CSV ë¡œ íŒŒì‹±
			const roa = XLSX.utils.sheet_to_csv(workbook.Sheets[sheetName]);

			if (roa.length > 0) {
				result[sheetName] = roa;
			}
		});
		return result;
	}

	// ì—‘ì…€ íŒŒì¼ ì‹œíŠ¸ì—ì„œ íŒŒì‹±í•œ JSON ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ ê·¸ë¦¬ë“œ ë™ì  ìƒì„±
	function createAUIGrid(csvStr) {
		if (AUIGrid.isCreated(myGridID)) {
			AUIGrid.destroy(myGridID);
			myGridID = null;
		}

		const jsonData = parseCsv(csvStr);
		const columnLayout = [];
		const gridProps = {
			selectionMode: "multipleCells"
		};

		// í˜„ì¬ ì—‘ì…€ íŒŒì¼ì˜ 0ë²ˆì§¸ í–‰ì„ ê¸°ì¤€ìœ¼ë¡œ ì»¬ëŸ¼ì„ ì‘ì„±í•¨.
		// ë§Œì•½ ìƒë‹¨ì— ë¬¸ì„œ ì œëª©ê³¼ ê°™ì´ ìˆëŠ” ê²½ìš°
		// ì¡°ì • í•„ìš”.
		const firstRow = jsonData[0];

		if (typeof firstRow === "undefined") {
			alert("AUIGrid ë¡œ ë³€í™˜í•  ìˆ˜ ì—†ëŠ” ì—‘ì…€ íŒŒì¼ì…ë‹ˆë‹¤.");
			return;
		}

		// Object.entries [key, value] ìŒìœ¼ë¡œ ë°˜ë³µ
		Object.entries(firstRow).forEach(([key], index) => {
			columnLayout.push({
				dataField: key,
				headerText: `Col${index + 1}`,
				width: 100
			});
		});

		// ê·¸ë¦¬ë“œ ìƒì„±
		myGridID = AUIGrid.create("#grid_wrap", columnLayout, gridProps);

		// ê·¸ë¦¬ë“œì— CSV ë°ì´í„° ì‚½ì…
		AUIGrid.setCsvGridData(myGridID, csvStr, false);
	}

	//ìµœì´ˆ ê·¸ë¦¬ë“œ ìƒì„±
	function createInitGrid() {
		const columnLayout = [];

		for (let i = 0; i < 20; i++) {
			columnLayout.push({
				dataField: `f${i}`,
				headerText: String.fromCharCode(65 + i),
				width: 80
			});
		}

		// ê·¸ë¦¬ë“œ ì†ì„± ì„¤ì •
		const gridProps = {
			noDataMessage: "ë¡œì»¬ PCì˜ ì—‘ì…€ íŒŒì¼ì„ ì„ íƒí•˜ì‹­ì‹œì˜¤."
		};

		// ì‹¤ì œë¡œ #grid_wrap ì— ê·¸ë¦¬ë“œ ìƒì„±
		myGridID = AUIGrid.create("#grid_wrap", columnLayout, gridProps);

		// ê·¸ë¦¬ë“œ ìµœì´ˆì— ë¹ˆ ë°ì´í„° ë„£ìŒ.
		AUIGrid.setGridData(myGridID, []);
	}

	function parseCsv(csvText) {
		const rows = csvText.trim().split('\n');
		return rows.map(row => row.split(','));
	}
</script>
</head>
<body>

<div id="main">
	<div class="desc">
		<p>AUIGrid ìì²´ì ìœ¼ë¡œ ì—‘ì…€ ì„í¬íŒ… ê¸°ëŠ¥ì€ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
		<p>ë‹¤ë§Œ, XLSX íŒŒì¼(ë˜ëŠ” XLS)ë¥¼ JSON ìœ¼ë¡œ íŒŒì‹±í•´ ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬(SheetJS js-xlsx)ë¥¼ í™œìš©í•˜ì—¬ ë™ì ìœ¼ë¡œ AUIGrid ì„í¬íŒ…ì„ êµ¬í˜„í•œ ì‘ìš© ë°ëª¨ì…ë‹ˆë‹¤.</p>
		<p> SheetJS ì˜ js-xlsx ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©, ì¶œì²˜ : <a href="https://github.com/SheetJS/js-xlsx" target="_blank">https://github.com/SheetJS/js-xlsx</a> </p>
		<p>SheetJS ì˜ js-xlsx ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì•„íŒŒì¹˜ ë¼ì´ì„¼ìŠ¤ 2.0 (Apache License v2.0, https://www.apache.org/licenses/LICENSE-2.0) ìœ¼ë¡œ ìƒì—…ì  ìš©ë„ë¡œ ì‚¬ìš©í•´ë„ ë¬´ë°©í•˜ë©° ì•„íŒŒì¹˜ ë¼ì´ì„¼ìŠ¤ 2.0 ì„ ëª…ì‹œí•´ì•¼ í•©ë‹ˆë‹¤.</p>
		<p>ë³¸ ë°ëª¨ëŠ” ê¸°ë³¸ì ì¸ êµ¬í˜„ ë°ëª¨ë¡œ, ì—‘ì…€ íŒŒì¼ì˜ ìƒë‹¨ì— ì œëª©ì´ë‚˜ ê¸°íƒ€ í…ìŠ¤íŠ¸ê°€ ì¡´ì¬í•œë‹¤ë©´ ì„¤ì •ì„ ë‹¤ë¥´ê²Œ í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.</p>
		<p>ë³¸ ë°ëª¨ëŠ” XLSX íŒŒì¼ì„ CSV ë¡œ íŒŒì‹±í•˜ì—¬ AUIGrid ì— CSV ë°ì´í„°ë¥¼ ì‚½ì…í•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.</p>
		<p>ì¦‰, SheetJS js-xlsx ë¥¼ í†µí•˜ì—¬ ì—‘ì…€ íŒŒì¼ì„ CSV ë¡œ íŒŒì‹±ì²˜ë¦¬í•œ í›„, ìƒì„±ëœ CSV í¬ë§· ë°ì´í„°ë¥¼ AUIGrid ì— ì‚½ì…í•©ë‹ˆë‹¤.</p>
		<!-- íŒŒì¼ ì½ê¸°  -->
		<label for="fileSelector" class="custom-file-upload">
			ğŸ“ íŒŒì¼ ì„ íƒí•˜ê¸°
		</label>
		<input type="file" id="fileSelector" name="files" accept=".xlsx">
	</div>
	<div>
		<!-- ì—ì´ìœ ì•„ì´ ê·¸ë¦¬ë“œê°€ ì´ê³³ì— ìƒì„±ë©ë‹ˆë‹¤. -->
		<div id="grid_wrap" style="width:100%;height:450px; margin:0 auto;"></div>
	</div>
	<div class="desc_bottom">
		<p id="elapse"></p>
	</div>
</div>
<div id="footer">
     <div class="copyright">
        <p>Copyright Â© AUISoft Co., Ltd. https://www.auisoft.net</p>
    </div>
</div>
</body>
</html>